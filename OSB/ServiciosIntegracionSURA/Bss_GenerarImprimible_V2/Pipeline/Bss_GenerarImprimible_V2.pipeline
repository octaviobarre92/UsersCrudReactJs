<?xml version="1.0" encoding="UTF-8"?>
<con:pipelineEntry xmlns:con="http://www.bea.com/wli/sb/pipeline/config" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <con:coreEntry>
        <con:binding type="SOAP" isSoap12="false" xsi:type="con:SoapBindingType">
            <con:wsdl ref="ComponentesComunes/WSDL/CCMSIV1"/>
            <con:binding>
                <con:name>PolizaBindingSOAP</con:name>
                <con:namespace>http://xmlns.sura.com/ServicioIntegracion/DominioPoliza/Poliza/V1</con:namespace>
            </con:binding>
        </con:binding>
        <con:xqConfiguration>
            <con:snippetVersion>1.0</con:snippetVersion>
        </con:xqConfiguration>
    </con:coreEntry>
    <con:router errorHandler="error-ad33703.7230350b.0.172af0b6bc4.N7b36">
        <con:pipeline type="request" name="request-ad33703.7230350b.0.172af0b6bc4.N8000">
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7f03" name="Validacion Entrada" errorHandler="error-ad33703.7230350b.0.172af0b6bc4.N7efd">
                <con:context>
                    <con1:userNsDecl prefix="v12" namespace="http://xmlns.sura.com/MensajeIntegracion/DominioUtilitario/GestionDocumentalMI/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v13" namespace="http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://xmlns.sura.com/MensajeIntegracion/DominioProceso/BPMMI/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:validate xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7f02</con2:id>
                        <con1:schema ref="ComponentesComunes/WSDL/xsd/DominioPoliza/Poliza/V1/PolizaMINV1"/>
                        <con1:schemaElement xmlns:v1="http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1">v1:GenerarImprimibleMsjSol</con1:schemaElement>
                        <con1:varName>body</con1:varName>
                        <con1:location>
                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol</con2:xpathText>
                        </con1:location>
                        <con1:resultVarName/>
                    </con1:validate>
                    <con1:assign varName="auditar" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7f01</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">dvm:lookup("DVM_Project/Constantes_DVM.dvm", "Atributo", "auditar", "Valor", "FALSE")</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="codigoOperacion" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7f00</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:CabeceraSol/v11:CodigoOperacion/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="fechaProcesamiento" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7eff</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:CabeceraSol/v11:FechaProcesamiento/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="idTransaccion" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7efe</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:CabeceraSol/v11:IdTransaccionOsb/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="sistemaOrigen" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N3f57fe8b.2727d3d0.0.17864e33bef.N7ffe</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:InfoImprimibleCustom/v13:OrigenSolicitud</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="poliza" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.3a57e551.0.17adfa466e8.N7ffb</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:InfoImprimible/v13:NumeroPoliza/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="docName" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N10719d66.0.17a2f14c37a.N7ffe</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:InfoImprimibleCustom/v13:DocName/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:assign varName="sistemaDestino" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.3a57e551.0.17adfa466e8.N7ffe</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v13:GenerarImprimibleMsjSol/v13:CabeceraSol/v11:SistemaDestino/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N10719d66.0.17a2f14c37a.N7ff7</con2:id>
                        <con1:script>process.exitoJavaWriter='0'
process.pathDocument= 'N/A'</con1:script>
                    </con1:javaScript>
                </con:actions>
            </con:stage>
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7e4d" name="Peticion Servicio ConsultarDocumentoInsis" errorHandler="error-ad33703.7230350b.0.172af0b6bc4.N7e44">
                <con:context>
                    <con1:userNsDecl prefix="v12" namespace="http://xmlns.sura.com/MensajeIntegracion/DominioUtilitario/GestionDocumentalMI/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N53e41fa5.N34e55a6e.0.1785f915a09.N7fb7</con2:id>
                        <con1:case id="_BranchId-N53e41fa5.N34e55a6e.0.1785f915a09.N7fb6">
                            <con1:condition>
                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($sistemaOrigen,'APPS')=0</con2:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:assign varName="Format">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N53e41fa5.N34e55a6e.0.1785f915a09.N7f33</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:InfoImprimibleCustom/v1:Formato/text()</con2:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="Business">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N53e41fa5.1011b267.0.1785fc134e2.N7ffe</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:InfoImprimibleCustom/v1:Negocio/text()</con2:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="Country">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N53e41fa5.1011b267.0.1785fc134e2.N7ffb</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:InfoImprimibleCustom/v1:Pais/text()</con2:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="documentoSalida">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N3f57fe8b.2727d3d0.0.17864e33bef.N7fe8</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:InfoImprimibleCustom/v1:Contenido/text()</con2:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="action">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N3f57fe8b.2727d3d0.0.17864e33bef.N7fe5</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:TipoEjecucion/text()</con2:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                                <con1:assign varName="Proceso">
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-N3f57fe89.N641c8eb3.0.179e3afdeea.N7ae3</con2:id>
                                    <con1:expr>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:InfoImprimibleCustom/v1:Proceso/text()</con2:xqueryText>
                                    </con1:expr>
                                </con1:assign>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:wsCallout>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e4c</con2:id>
                                <con1:service ref="Bss_GenerarImprimible_V2/Resources/Database/dbLoadDataXML" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con1:operation>dbLoadDataXML</con1:operation>
                                <con1:request>
                                    <con1:body wrapped="false">RqConsultarDocumentoInsis</con1:body>
                                </con1:request>
                                <con1:response>
                                    <con1:body wrapped="false">RsConsultarDocumentoInsis</con1:body>
                                </con1:response>
                                <con1:requestTransform>
                                    <con1:assign varName="RqConsultarDocumentoInsis">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e4b</con2:id>
                                        <con1:expr>
                                            <con2:xsltTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                <con2:resource ref="Bss_GenerarImprimible_V2/Resources/xslt/TIN_BssGenerarImprimible_V2_to_SPLoadDataXML"/>
                                                <con2:input>$body/*</con2:input>
                                            </con2:xsltTransform>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:requestTransform>
                                <con1:responseTransform>
                                    <con1:assign varName="mensajeXML">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e4a</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsConsultarDocumentoInsis</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="mensaje">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e48</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsConsultarDocumentoInsis/*:PO_MSG_ERROR/text()</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="serviceResp">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e47</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsConsultarDocumentoInsis/*:PO_MSG_STATUS/text()</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="action">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e46</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsConsultarDocumentoInsis/*:PO_ACTION/text()</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="idProceso">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e45</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsConsultarDocumentoInsis/*:PO_PROCID/text()</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="docName">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N474c2066.0.172f7910332.N7fb9</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsConsultarDocumentoInsis/*:PO_DOCNAME/text()</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="tipoOper">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.3027e79.0.172fc75ba6e.N7f92</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body/v1:GenerarImprimibleMsjSol/v1:CodigoOperacion</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="exitoJavaWriter">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7fc0</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'0'</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:assign varName="pathDocument">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7f8c</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'n/a'</con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                </con1:responseTransform>
                            </con1:wsCallout>
                            <con1:ifThenElse>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f67</con2:id>
                                <con1:case id="_BranchId-ad33703.34f06aa9.0.173029e7e13.N7f66">
                                    <con1:condition>
                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($serviceResp,"OK")= 0</con2:xqueryText>
                                    </con1:condition>
                                    <con1:actions>
                                        <con2:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f65</con3:id>
                                            <con2:case id="_BranchId-ad33703.34f06aa9.0.173029e7e13.N7f64">
                                                <con2:condition>
                                                    <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:compare($auditar, "true")=0</con3:xqueryText>
                                                </con2:condition>
                                                <con2:actions>
                                                    <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f63</con3:id>
                                                        <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "200",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": "Transaccion Exitosa",
"ORIGEN": "OSB"
}
}</con1:script>
                                                    </con1:javaScript>
                                                    <con1:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f62</con3:id>
                                                        <con1:location>
                                                            <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                                                        </con1:location>
                                                        <con1:expr>
                                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$auditoria</con3:xqueryText>
                                                        </con1:expr>
                                                    </con1:replace>
                                                    <con3:route xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config">
                                                        <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f61</con4:id>
                                                        <con3:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                        <con3:outboundTransform/>
                                                    </con3:route>
                                                </con2:actions>
                                            </con2:case>
                                            <con2:default/>
                                        </con2:ifThenElse>
                                    </con1:actions>
                                </con1:case>
                                <con1:default>
                                    <con1:javaScript>
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f60</con2:id>
                                        <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "400",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": process.mensaje,
"ORIGEN": "OSB"
}
}</con1:script>
                                    </con1:javaScript>
                                    <con1:replace contents-only="true" varName="body">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f5f</con2:id>
                                        <con1:location>
                                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                        </con1:location>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                                        </con1:expr>
                                    </con1:replace>
                                    <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.34f06aa9.0.173029e7e13.N7f5e</con3:id>
                                        <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                        <con2:outboundTransform/>
                                    </con2:route>
                                    <con1:assign varName="RsErrorAux">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.5e4d5a27.0.17302f772ff.N7ea8</con2:id>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<v1:GenerarImprimibleMsjResp>
         <v1:CabeceraResp>
            <v11:EstadoGeneral>
               <v11:Status>{$serviceResp}</v11:Status>
               <v11:Descripcion>{$mensaje}</v11:Descripcion>
            </v11:EstadoGeneral>
         </v1:CabeceraResp>
      </v1:GenerarImprimibleMsjResp>]]></con2:xqueryText>
                                        </con1:expr>
                                    </con1:assign>
                                    <con1:replace varName="body" contents-only="true">
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.5e4d5a27.0.17302f772ff.N7ea2</con2:id>
                                        <con1:location>
                                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                        </con1:location>
                                        <con1:expr>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsErrorAux</con2:xqueryText>
                                        </con1:expr>
                                    </con1:replace>
                                    <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                        <con2:id>_ActionId-ad33703.5e4d5a27.0.17302f772ff.N7ea5</con2:id>
                                    </con2:reply>
                                </con1:default>
                            </con1:ifThenElse>
                            <con1:wsCallout>
                                <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">Servicio encargado de realizar la transformacion del Json.</con2:comment>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7a0e</con2:id>
                                <con1:service ref="TransformDocInsis/ProxyService/TransformDocInsisPS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con1:request>
                                    <con1:payload wrapped="false">mensajeXML</con1:payload>
                                </con1:request>
                                <con1:response>
                                    <con1:payload wrapped="false">RsJson</con1:payload>
                                </con1:response>
                                <con1:requestTransform>
                                    <con1:transport-headers>
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7a0d</con2:id>
                                        <con1:header-set>outbound-request</con1:header-set>
                                        <con1:header value="expression" name="Content-Type">
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'application/xml'</con2:xqueryText>
                                        </con1:header>
                                    </con1:transport-headers>
                                </con1:requestTransform>
                                <con1:responseTransform>
                                    <con1:transport-headers>
                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7a0c</con2:id>
                                        <con1:header-set>inbound-response</con1:header-set>
                                        <con1:header value="expression" name="Content-Type">
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'application/json'</con2:xqueryText>
                                        </con1:header>
                                    </con1:transport-headers>
                                </con1:responseTransform>
                            </con1:wsCallout>
                            <con1:javaScript>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7a0b</con2:id>
                                <con1:script>process.Format = process.RsJson.Document[0].Control.Format

process.Country = process.RsJson.Document[0].Control.Country

process.Business = process.RsJson.Document[0].Control.Business

process.Proceso = process.RsJson.Document[0].Control.Process</con1:script>
                            </con1:javaScript>
                            <con1:assign varName="RsJsonAux">
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N15cfa166.0.1731780d80b.N7ff8</con2:id>
                                <con1:expr>
                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:replace($RsJson,"NULL","")</con2:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:javaCallout varName="documentoSalida">
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7d45</con2:id>
                                <con1:archive ref="Bss_GenerarImprimible_V2/Resources/JavaEncoder/base64encoder"/>
                                <con1:className>com.sura.EncoderDocument</con1:className>
                                <con1:method>public static java.lang.String encode(java.lang.String)</con1:method>
                                <con1:expr>
                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsJsonAux</con2:xqueryText>
                                </con1:expr>
                                <con1:return-param-as-ref>false</con1:return-param-as-ref>
                            </con1:javaCallout>
                        </con1:default>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
            <con:stage id="_StageId-ad33703.4d0dcc9d.0.17ac47d973e.N8000" name="Dat_ObtenerCaratula">
                <con:context>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.4d0dcc9d.0.17ac47d973e.N7ff6</con2:id>
                        <con1:case id="_BranchId-ad33703.4d0dcc9d.0.17ac47d973e.N7ff5">
                            <con1:condition>
                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($sistemaDestino,'GWI')=0</con2:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:wsCallout>
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.4d0dcc9d.0.17ac47d973e.N7ff2</con2:id>
                                    <con1:service ref="Dat_ObtenerCaratula/ProxyService/Dat_ObtenerCaratulaPS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con1:request>
                                        <con1:payload wrapped="false">RqObtenerCaratula</con1:payload>
                                    </con1:request>
                                    <con1:response>
                                        <con1:payload wrapped="false">RsObtenerCaratula</con1:payload>
                                    </con1:response>
                                    <con1:requestTransform>
                                        <con1:javaScript>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.4d0dcc9d.0.17ac47d973e.N7fef</con2:id>
                                            <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.RqObtenerCaratula=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"GWI",
"SISTEMA_ORIGEN":"OSB",
},
"LOGO":true,
"POLIZA": process.poliza
}</con1:script>
                                        </con1:javaScript>
                                        <con1:transport-headers>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.4d0dcc9d.0.17ac47d973e.N7fec</con2:id>
                                            <con1:header-set>outbound-request</con1:header-set>
                                            <con1:header value="expression" name="Content-Type">
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'application/json'</con2:xqueryText>
                                            </con1:header>
                                        </con1:transport-headers>
                                    </con1:requestTransform>
                                    <con1:responseTransform>
                                        <con1:insert varName="inbound">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7eb1</con2:id>
                                            <con1:location>
                                                <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">./ctx:transport/ctx:response</con2:xpathText>
                                            </con1:location>
                                            <con1:where>first-child</con1:where>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$outbound/ctx:transport/ctx:response/http:http-response-code</con2:xqueryText>
                                            </con1:expr>
                                        </con1:insert>
                                        <con1:assign varName="codigoHttp">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7ead</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$inbound/ctx:transport/ctx:response/http:http-response-code/text()</con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:javaScript>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.4d0dcc9d.0.17ac47d973e.N7fe9</con2:id>
                                            <con1:script>process.codigoHttp= process.RsObtenerCaratula.STATUS.CODIGO
if ((process.codigoHttp==200)){
process.exito =true
process.documentoGWI = process.RsObtenerCaratula.DOCUMENTO
}else{
process.exito=false
process.mensaje = process.RsObtenerCaratula.STATUS.DETALLE
process.serviceResp = 'ERR'
}</con1:script>
                                        </con1:javaScript>
                                    </con1:responseTransform>
                                </con1:wsCallout>
                                <con1:ifThenElse>
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7f64</con2:id>
                                    <con1:case id="_BranchId-af03c07.N5dc3a2d7.0.17adfd50790.N7f63">
                                        <con1:condition>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$exito</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con2:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                                                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7f62</con3:id>
                                                <con2:case id="_BranchId-af03c07.N5dc3a2d7.0.17adfd50790.N7f61">
                                                    <con2:condition>
                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:compare($auditar, "true")=0</con3:xqueryText>
                                                    </con2:condition>
                                                    <con2:actions>
                                                        <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7f60</con3:id>
                                                            <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.body=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"WS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": 200,
"COMPONENTE": process.componenteError,
"DETALLE": "Transaccion exitosa",
"ORIGEN": process.origenError
}
}</con1:script>
                                                        </con1:javaScript>
                                                        <con3:route xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config">
                                                            <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7f5f</con4:id>
                                                            <con3:service ref="EnviarAuditoria_v1.0.0/EnviarAuditoria_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                            <con3:outboundTransform/>
                                                        </con3:route>
                                                    </con2:actions>
                                                </con2:case>
                                                <con2:default/>
                                            </con2:ifThenElse>
                                            <con1:assign varName="RsBody">
                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7eaa</con2:id>
                                                <con1:expr>
                                                    <con2:xsltTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                        <con2:resource ref="Bss_GenerarImprimible_V2/Resources/xslt/TOUT_GWI_to_EXP"/>
                                                        <con2:input>$body</con2:input>
                                                        <con2:param name="documentoGWI">
                                                            <con2:path>$documentoGWI</con2:path>
                                                        </con2:param>
                                                    </con2:xsltTransform>
                                                </con1:expr>
                                            </con1:assign>
                                            <con1:replace varName="body" contents-only="true">
                                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7ea6</con2:id>
                                                <con1:location>
                                                    <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                                </con1:location>
                                                <con1:expr>
                                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsBody</con2:xqueryText>
                                                </con1:expr>
                                            </con1:replace>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                        <con1:javaScript>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7f23</con2:id>
                                            <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "400",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": process.mensaje,
"ORIGEN": "OSB"
}
}</con1:script>
                                        </con1:javaScript>
                                        <con1:replace contents-only="true" varName="body">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7f1f</con2:id>
                                            <con1:location>
                                                <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                            </con1:location>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                                            </con1:expr>
                                        </con1:replace>
                                        <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7eeb</con3:id>
                                            <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con2:outboundTransform/>
                                        </con2:route>
                                        <con1:assign varName="RsErrorBody">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7eb7</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<v1:GenerarImprimibleMsjResp>
         <v1:CabeceraResp>
            <v11:EstadoGeneral>
               <v11:Status>{$serviceResp}</v11:Status>
               <v11:Descripcion>{$mensaje}</v11:Descripcion>
            </v11:EstadoGeneral>
         </v1:CabeceraResp>
      </v1:GenerarImprimibleMsjResp>]]></con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:replace varName="body" contents-only="true">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-af03c07.N5dc3a2d7.0.17adfd50790.N7eb4</con2:id>
                                            <con1:location>
                                                <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                            </con1:location>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsErrorBody</con2:xqueryText>
                                            </con1:expr>
                                        </con1:replace>
                                    </con1:default>
                                </con1:ifThenElse>
                                <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                    <con2:id>_ActionId-ad33703.4d0dcc9d.0.17ac47d973e.N7fe6</con2:id>
                                </con2:reply>
                            </con1:actions>
                        </con1:case>
                        <con1:default/>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7d79" name="MensajeCCM">
                <con:context/>
                <con:actions>
                    <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7d40</con2:id>
                        <con1:script>process.RqGetDocument=
{

"Format": process.Format,

"Country": process.Country,

"Business":process.Business,

"Process":process.Proceso,

"Content":process.documentoSalida
}</con1:script>
                    </con1:javaScript>
                </con:actions>
            </con:stage>
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7db7" name="Validacion Tipo Accion">
                <con:context>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7db6</con2:id>
                        <con1:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7db5">
                            <con1:condition>
                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($action,"E")=0</con2:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7d3d</con3:id>
                                    <con2:service ref="Dat_EnviarDocumentoMQ_V2/ProxyService/Dat_EnviarDocumentoMQ_V2_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                    <con2:outboundTransform>
                                        <con1:javaScript>
                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7ee1</con3:id>
                                            <con1:script>process.bodyAuxWS=
{
"Content":process.documentoSalida
}</con1:script>
                                        </con1:javaScript>
                                        <con1:replace contents-only="true" varName="body">
                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7ede</con3:id>
                                            <con1:location>
                                                <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                                            </con1:location>
                                            <con1:expr>
                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$bodyAuxWS</con3:xqueryText>
                                            </con1:expr>
                                        </con1:replace>
                                    </con2:outboundTransform>
                                </con2:route>
                            </con1:actions>
                        </con1:case>
                        <con1:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7d82">
                            <con1:condition>
                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($action,"B")=0 or fn:compare($action,"P")=0</con2:xqueryText>
                            </con1:condition>
                            <con1:actions>
                                <con1:ifThenElse>
                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7d7b</con2:id>
                                    <con1:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7d7a">
                                        <con1:condition>
                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($operId,"03")=0</con2:xqueryText>
                                        </con1:condition>
                                        <con1:actions>
                                            <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7e3c</con3:id>
                                                <con2:service ref="Dat_EnviarDocumentoMQ_V2/ProxyService/Dat_EnviarDocumentoMQ_V2_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                <con2:outboundTransform>
                                                    <con1:javaScript>
                                                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7e3b</con3:id>
                                                        <con1:script>process.bodyAuxWS=
{
"Content":process.documentoSalida
}</con1:script>
                                                    </con1:javaScript>
                                                    <con1:replace contents-only="true" varName="body">
                                                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7e3a</con3:id>
                                                        <con1:location>
                                                            <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                                                        </con1:location>
                                                        <con1:expr>
                                                            <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$bodyAuxWS</con3:xqueryText>
                                                        </con1:expr>
                                                    </con1:replace>
                                                </con2:outboundTransform>
                                            </con2:route>
                                        </con1:actions>
                                    </con1:case>
                                    <con1:default>
                                        <con1:wsCallout>
                                            <con2:comment xmlns:con2="http://www.bea.com/wli/sb/stages/config">Se realiza la invocacin al servicio GetDocument de CCM.</con2:comment>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7cd2</con2:id>
                                            <con1:service ref="Bss_GenerarImprimible_V2/BusinessService/CCMWebService_BS" xsi:type="ref:BusinessServiceRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                            <con1:operation>GetDocument</con1:operation>
                                            <con1:request>
                                                <con1:payload wrapped="false">RqGetDocument</con1:payload>
                                            </con1:request>
                                            <con1:response>
                                                <con1:payload wrapped="false">RsGetDocument</con1:payload>
                                            </con1:response>
                                            <con1:requestTransform>
                                                <con1:transport-headers>
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7cd1</con2:id>
                                                    <con1:header-set>outbound-request</con1:header-set>
                                                    <con1:header value="expression" name="Content-Type">
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'application/json'</con2:xqueryText>
                                                    </con1:header>
                                                </con1:transport-headers>
                                            </con1:requestTransform>
                                            <con1:responseTransform/>
                                        </con1:wsCallout>
                                        <con1:assign varName="serviceResp">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7e27</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'OK'</con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:assign varName="DocTransformadoWSCCM">
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N384fe5f6.0.172b31e8453.N7fcd</con2:id>
                                            <con1:expr>
                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsGetDocument</con2:xqueryText>
                                            </con1:expr>
                                        </con1:assign>
                                        <con1:ifThenElse>
                                            <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c1c</con2:id>
                                            <con1:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7c1b">
                                                <con1:condition>
                                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($serviceResp,"OK")= 0</con2:xqueryText>
                                                </con1:condition>
                                                <con1:actions>
                                                    <con2:ifThenElse xmlns:con1="http://www.bea.com/wli/sb/stages/routing/config" xmlns:con2="http://www.bea.com/wli/sb/stages/transform/config">
                                                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c1a</con3:id>
                                                        <con2:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7c19">
                                                            <con2:condition>
                                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">fn:compare($auditar, "true")=0</con3:xqueryText>
                                                            </con2:condition>
                                                            <con2:actions>
                                                                <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c18</con3:id>
                                                                    <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "200",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": "Transaccion Exitosa",
"ORIGEN": "OSB"
}
}</con1:script>
                                                                </con1:javaScript>
                                                                <con1:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                                                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c17</con3:id>
                                                                    <con1:location>
                                                                        <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                                                                    </con1:location>
                                                                    <con1:expr>
                                                                        <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$auditoria</con3:xqueryText>
                                                                    </con1:expr>
                                                                </con1:replace>
                                                                <con3:route xmlns:con3="http://www.bea.com/wli/sb/stages/publish/config">
                                                                    <con4:id xmlns:con4="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c16</con4:id>
                                                                    <con3:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                    <con3:outboundTransform/>
                                                                </con3:route>
                                                            </con2:actions>
                                                        </con2:case>
                                                        <con2:default/>
                                                    </con2:ifThenElse>
                                                    <con1:javaCallout varName="pathDocument">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N474c2066.0.172f7910332.N7fc2</con2:id>
                                                        <con1:archive ref="Bss_GenerarImprimible_V2/Resources/JavaEncoder/JPdfWriterV1"/>
                                                        <con1:className>com.sura.PdfWriter</con1:className>
                                                        <con1:method>public static java.lang.String WritePDF(java.lang.String, java.lang.String)</con1:method>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsGetDocument</con2:xqueryText>
                                                        </con1:expr>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$docName</con2:xqueryText>
                                                        </con1:expr>
                                                        <con1:return-param-as-ref>false</con1:return-param-as-ref>
                                                    </con1:javaCallout>
                                                    <con1:assign varName="exitoJavaWriter">
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.4ebb84d2.0.172beb70365.N7b87</con2:id>
                                                        <con1:expr>
                                                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">'1'</con2:xqueryText>
                                                        </con1:expr>
                                                    </con1:assign>
                                                    <con1:ifThenElse>
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ab6</con2:id>
                                                        <con1:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7ab5">
                                                            <con1:condition>
                                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">fn:compare($action,"B")=0</con2:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                                <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7d84</con3:id>
                                                                    <con2:service ref="Dat_EnviarDocumentoMQ_V2/ProxyService/Dat_EnviarDocumentoMQ_V2_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                    <con2:outboundTransform>
                                                                        <con1:javaScript>
                                                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7d83</con3:id>
                                                                            <con1:script>process.bodyAuxWS=
{
"Content":process.documentoSalida
}</con1:script>
                                                                        </con1:javaScript>
                                                                        <con1:replace contents-only="true" varName="body">
                                                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7d82</con3:id>
                                                                            <con1:location>
                                                                                <con3:xpathText xmlns:con3="http://www.bea.com/wli/sb/stages/config">.</con3:xpathText>
                                                                            </con1:location>
                                                                            <con1:expr>
                                                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$bodyAuxWS</con3:xqueryText>
                                                                            </con1:expr>
                                                                        </con1:replace>
                                                                    </con2:outboundTransform>
                                                                </con2:route>
                                                            </con1:actions>
                                                        </con1:case>
                                                        <con1:default/>
                                                    </con1:ifThenElse>
                                                    <con1:ifThenElse>
                                                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c13</con2:id>
                                                        <con1:case id="_BranchId-ad33703.7230350b.0.172af0b6bc4.N7c12">
                                                            <con1:condition>
                                                                <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">(fn:compare($tipoOper,"02")= 0 or fn:compare($tipoOper,"04") = 0)</con2:xqueryText>
                                                            </con1:condition>
                                                            <con1:actions>
                                                                <con1:assign varName="RsAuxBodyGenerar">
                                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.3027e79.0.172fc75ba6e.N7f7f</con2:id>
                                                                    <con1:expr>
                                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$body</con2:xqueryText>
                                                                    </con1:expr>
                                                                </con1:assign>
                                                                <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                                                    <con3:comment xmlns:con3="http://www.bea.com/wli/sb/stages/config">Se realiza el llamado asincrono al servicio de CargarDocumento de ECM.</con3:comment>
                                                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c11</con3:id>
                                                                    <con2:service ref="Bss_CargarDocumento/ProxyService/Bss_CargarDocumentoPS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                                    <con2:operation>CargarDocumento</con2:operation>
                                                                    <con2:outboundTransform>
                                                                        <con1:assign varName="cargarDocumento">
                                                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N5ec5c942.0.172b0807c8a.N7d7d</con3:id>
                                                                            <con1:expr>
                                                                                <con3:xsltTransform xmlns:con3="http://www.bea.com/wli/sb/stages/config">
                                                                                    <con3:resource ref="Bss_GenerarImprimible_V2/Resources/xslt/TIN_BssGenerarImpr_to_BssCargarDocumento"/>
                                                                                    <con3:input>$body/*</con3:input>
                                                                                    <con3:param name="documentoBase64">
                                                                                        <con3:path>$DocTransformadoWSCCM</con3:path>
                                                                                    </con3:param>
                                                                                    <con3:param name="documentPath">
                                                                                        <con3:path>$pathDocument</con3:path>
                                                                                    </con3:param>
                                                                                    <con3:param name="extension">
                                                                                        <con3:path>$Format</con3:path>
                                                                                    </con3:param>
                                                                                </con3:xsltTransform>
                                                                            </con1:expr>
                                                                        </con1:assign>
                                                                        <con1:replace varName="body" contents-only="true">
                                                                            <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.3027e79.0.172fc75ba6e.N7f82</con3:id>
                                                                            <con1:expr>
                                                                                <con3:xqueryText xmlns:con3="http://www.bea.com/wli/sb/stages/config">$cargarDocumento</con3:xqueryText>
                                                                            </con1:expr>
                                                                        </con1:replace>
                                                                    </con2:outboundTransform>
                                                                </con2:route>
                                                                <con1:replace varName="body" contents-only="true">
                                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.3027e79.0.172fc75ba6e.N7f49</con2:id>
                                                                    <con1:location>
                                                                        <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                                                    </con1:location>
                                                                    <con1:expr>
                                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsAuxBodyGenerar</con2:xqueryText>
                                                                    </con1:expr>
                                                                </con1:replace>
                                                            </con1:actions>
                                                        </con1:case>
                                                        <con1:default/>
                                                    </con1:ifThenElse>
                                                </con1:actions>
                                            </con1:case>
                                            <con1:default>
                                                <con1:javaScript>
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c10</con2:id>
                                                    <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "400",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": process.mensaje,
"ORIGEN": "OSB"
}
}</con1:script>
                                                </con1:javaScript>
                                                <con1:replace contents-only="true" varName="body">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c0f</con2:id>
                                                    <con1:location>
                                                        <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                                    </con1:location>
                                                    <con1:expr>
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                                                    </con1:expr>
                                                </con1:replace>
                                                <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                                    <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c0e</con3:id>
                                                    <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                                    <con2:outboundTransform/>
                                                </con2:route>
                                                <con1:assign varName="RsErrorBody">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c0d</con2:id>
                                                    <con1:expr>
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<v1:GenerarImprimibleMsjResp>
         <v1:CabeceraResp>
            <v11:EstadoGeneral>
               <v11:Status>{$serviceResp}</v11:Status>
               <v11:Descripcion>{$mensaje}</v11:Descripcion>
            </v11:EstadoGeneral>
         </v1:CabeceraResp>
      </v1:GenerarImprimibleMsjResp>]]></con2:xqueryText>
                                                    </con1:expr>
                                                </con1:assign>
                                                <con1:replace varName="body" contents-only="true">
                                                    <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c0c</con2:id>
                                                    <con1:location>
                                                        <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                                    </con1:location>
                                                    <con1:expr>
                                                        <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsErrorBody</con2:xqueryText>
                                                    </con1:expr>
                                                </con1:replace>
                                                <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                                    <con2:id>_ActionId-ad33703.7230350b.0.172af0b6bc4.N7c0b</con2:id>
                                                </con2:reply>
                                            </con1:default>
                                        </con1:ifThenElse>
                                    </con1:default>
                                </con1:ifThenElse>
                            </con1:actions>
                        </con1:case>
                        <con1:default>
                            <con1:javaScript>
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7ef3</con2:id>
                                <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "400",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": "Operacion no valida",
"ORIGEN": "OSB"
}
}</con1:script>
                            </con1:javaScript>
                            <con1:replace contents-only="true" varName="body">
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7ef0</con2:id>
                                <con1:location>
                                    <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                </con1:location>
                                <con1:expr>
                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                                </con1:expr>
                            </con1:replace>
                            <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config">
                                <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7ebc</con3:id>
                                <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                                <con2:outboundTransform/>
                            </con2:route>
                            <con1:assign varName="RsErrorAux">
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7e88</con2:id>
                                <con1:expr>
                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config"><![CDATA[<v1:GenerarImprimibleMsjResp>
         <v1:CabeceraResp>
            <v11:EstadoGeneral>
               <v11:Status>ERR</v11:Status>
               <v11:Descripcion>Operacin No Vlida</v11:Descripcion>
            </v11:EstadoGeneral>
         </v1:CabeceraResp>
      </v1:GenerarImprimibleMsjResp>]]></con2:xqueryText>
                                </con1:expr>
                            </con1:assign>
                            <con1:replace varName="body" contents-only="true">
                                <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.N2dd30b68.0.1730771214f.N7e84</con2:id>
                                <con1:location>
                                    <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                                </con1:location>
                                <con1:expr>
                                    <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsErrorAux</con2:xqueryText>
                                </con1:expr>
                            </con1:replace>
                            <con2:reply xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                <con2:id>_ActionId-ad33703.N2dd30b68.0.1730771214f.N7e81</con2:id>
                            </con2:reply>
                        </con1:default>
                    </con1:ifThenElse>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="response" name="response-ad33703.7230350b.0.172af0b6bc4.N7fff">
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7ba2" name="Response">
                <con:context>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:assign varName="RsBody" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ba1</con2:id>
                        <con1:expr>
                            <con2:xsltTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                <con2:resource ref="Bss_GenerarImprimible_V2/Resources/xslt/TOUT_BssResponse"/>
                                <con2:input>$body</con2:input>
                                <con2:param name="urlDoc">
                                    <con2:path>$pathDocument</con2:path>
                                </con2:param>
                                <con2:param name="exitoJava">
                                    <con2:path>$exitoJavaWriter</con2:path>
                                </con2:param>
                                <con2:param name="documento">
                                    <con2:path>fn:concat('data:application/',$Format,';base64,',$RsGetDocument)</con2:path>
                                </con2:param>
                            </con2:xsltTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ba0</con2:id>
                        <con1:location>
                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$RsBody</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="error" name="error-ad33703.7230350b.0.172af0b6bc4.N7efd">
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7efc" name="ErrorHandler">
                <con:context>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://xmlns.sura.com/MensajeIntegracion/DominioProceso/BPMMI/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:assign varName="mensaje" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7efb</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault/ctx:reason/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7efa</con2:id>
                        <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "404",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": process.mensaje,
"ORIGEN": "OSB"
}
}</con1:script>
                    </con1:javaScript>
                    <con1:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ef9</con2:id>
                        <con1:location>
                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ef8</con3:id>
                        <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:outboundTransform/>
                    </con2:route>
                    <con1:assign varName="cuerpo" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ef7</con2:id>
                        <con1:expr>
                            <con2:xsltTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                <con2:resource ref="ComponentesComunes/XSLT/ErrorGeneral"/>
                                <con2:input>$fault</con2:input>
                                <con2:param name="bm.tns">
                                    <con2:path>"http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1"</con2:path>
                                </con2:param>
                                <con2:param name="operation">
                                    <con2:path>"GenerarImprimible"</con2:path>
                                </con2:param>
                                <con2:param name="status">
                                    <con2:path>"ErrorTecnico"</con2:path>
                                </con2:param>
                                <con2:param name="descripcion">
                                    <con2:path>"Peticion Invalida"</con2:path>
                                </con2:param>
                                <con2:param name="componente">
                                    <con2:path>"Bss_GenerarImprimible"</con2:path>
                                </con2:param>
                                <con2:param name="codigoError">
                                    <con2:path>$fault/ctx:errorCode</con2:path>
                                </con2:param>
                                <con2:param name="detalleError">
                                    <con2:path>$fault/ctx:reason/text()</con2:path>
                                </con2:param>
                                <con2:param name="mensajeError">
                                    <con2:path>$fault/ctx:details[1]/*:ValidationFailureDetail/*:message/text()</con2:path>
                                </con2:param>
                                <con2:param name="location">
                                    <con2:path>$fault/ctx:location/*:stage/text()</con2:path>
                                </con2:param>
                            </con2:xsltTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ef6</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$cuerpo</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:reply xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ef5</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="error" name="error-ad33703.7230350b.0.172af0b6bc4.N7e44">
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7e43" name="ErrorHandler">
                <con:context>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://xmlns.sura.com/MensajeIntegracion/DominioProceso/BPMMI/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:assign varName="mensaje" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e42</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault/ctx:reason/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e41</con2:id>
                        <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "404",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": process.mensaje,
"ORIGEN": "OSB"
}
}</con1:script>
                    </con1:javaScript>
                    <con1:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e40</con2:id>
                        <con1:location>
                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e3f</con3:id>
                        <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:outboundTransform/>
                    </con2:route>
                    <con1:assign varName="cuerpo" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e3e</con2:id>
                        <con1:expr>
                            <con2:xsltTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                <con2:resource ref="ComponentesComunes/XSLT/ErrorGeneral"/>
                                <con2:input>$fault</con2:input>
                                <con2:param name="bm.tns">
                                    <con2:path>"http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1"</con2:path>
                                </con2:param>
                                <con2:param name="operation">
                                    <con2:path>"GenerarImprimible"</con2:path>
                                </con2:param>
                                <con2:param name="status">
                                    <con2:path>"ErrorTecnico"</con2:path>
                                </con2:param>
                                <con2:param name="descripcion">
                                    <con2:path>"Error en la invocacion del servicio de negocio"</con2:path>
                                </con2:param>
                                <con2:param name="componente">
                                    <con2:path>"Bss_GenerarImprimible"</con2:path>
                                </con2:param>
                                <con2:param name="codigoError">
                                    <con2:path>$fault/ctx:errorCode</con2:path>
                                </con2:param>
                                <con2:param name="detalleError">
                                    <con2:path>$fault/ctx:reason/text()</con2:path>
                                </con2:param>
                                <con2:param name="mensajeError">
                                    <con2:path>$fault/ctx:reason/text()</con2:path>
                                </con2:param>
                                <con2:param name="location">
                                    <con2:path>$fault/ctx:location/*:stage/text()</con2:path>
                                </con2:param>
                            </con2:xsltTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e3d</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$cuerpo</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:reply xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-ad33703.7230350b.0.172af0b6bc4.N7e3c</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:pipeline type="error" name="error-ad33703.7230350b.0.172af0b6bc4.N7b36">
            <con:stage id="_StageId-ad33703.7230350b.0.172af0b6bc4.N7ac4" name="ErrorHandler">
                <con:context>
                    <con1:userNsDecl prefix="v11" namespace="http://xmlns.sura.com/ObjetoEmpresarial/DominioComun/Comun/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                    <con1:userNsDecl prefix="v1" namespace="http://xmlns.sura.com/MensajeIntegracion/DominioProceso/BPMMI/V1" xmlns:con1="http://www.bea.com/wli/sb/stages/config"/>
                </con:context>
                <con:actions>
                    <con1:assign varName="mensaje" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ac3</con2:id>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$fault/ctx:reason/text()</con2:xqueryText>
                        </con1:expr>
                    </con1:assign>
                    <con1:javaScript xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ac2</con2:id>
                        <con1:script>var today = new Date()
var date = today.getFullYear()+'/'+(today.getMonth()+1)+'/'+today.getDate();
process.auditoria=
{
"CABECERA":{
"CODIGO_OPERACION":process.codigoOperacion,
"FECHA_PROCESAMIENTO":process.fechaProcesamiento,
"FECHA_TRANSACCION":date,
"ID_TRANSACCION_OSB":process.idTransaccion,
"SISTEMA_DESTINO":"INSIS",
"SISTEMA_ORIGEN":"OSB",
},
"STATUS":{
"CODIGO": "404",
"COMPONENTE": "Bss_GenerarImprimible_V2",
"DETALLE": process.mensaje,
"ORIGEN": "OSB"
}
}</con1:script>
                    </con1:javaScript>
                    <con1:replace contents-only="true" varName="body" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ac1</con2:id>
                        <con1:location>
                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$auditoria</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con2:route xmlns:con2="http://www.bea.com/wli/sb/stages/publish/config" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con3:id xmlns:con3="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7ac0</con3:id>
                        <con2:service ref="EnviarAuditoria_v2.0.0/ProxyService/EnviarAuditoria_v2.0.0_PS" xsi:type="ref:ProxyRef" xmlns:ref="http://www.bea.com/wli/sb/reference"/>
                        <con2:outboundTransform/>
                    </con2:route>
                    <con1:assign varName="cuerpo" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7abf</con2:id>
                        <con1:expr>
                            <con2:xsltTransform xmlns:con2="http://www.bea.com/wli/sb/stages/config">
                                <con2:resource ref="ComponentesComunes/XSLT/ErrorGeneral"/>
                                <con2:input>$fault</con2:input>
                                <con2:param name="bm.tns">
                                    <con2:path>"http://www.sura.com/MensajeIntegracion/DominioPoliza/PolizaMIN/V1"</con2:path>
                                </con2:param>
                                <con2:param name="operation">
                                    <con2:path>"GenerarImprimible"</con2:path>
                                </con2:param>
                                <con2:param name="status">
                                    <con2:path>"ERR"</con2:path>
                                </con2:param>
                                <con2:param name="descripcion">
                                    <con2:path>"Error general no identificado"</con2:path>
                                </con2:param>
                                <con2:param name="componente">
                                    <con2:path>"Bss_GenerarImprimible"</con2:path>
                                </con2:param>
                                <con2:param name="codigoError">
                                    <con2:path>$fault/ctx:errorCode</con2:path>
                                </con2:param>
                                <con2:param name="detalleError">
                                    <con2:path>fn:concat($fault/ctx:reason/text(), " ",$fault/*:details/*:ErrorResponseDetail/*:detail)</con2:path>
                                </con2:param>
                                <con2:param name="mensajeError">
                                    <con2:path>fn:concat($fault/ctx:reason/text(), " ",$fault/*:details/*:ErrorResponseDetail/*:detail)</con2:path>
                                </con2:param>
                                <con2:param name="location">
                                    <con2:path>$fault/ctx:location/*:stage/text()</con2:path>
                                </con2:param>
                            </con2:xsltTransform>
                        </con1:expr>
                    </con1:assign>
                    <con1:replace varName="body" contents-only="true" xmlns:con1="http://www.bea.com/wli/sb/stages/transform/config">
                        <con2:id xmlns:con2="http://www.bea.com/wli/sb/stages/config">_ActionId-ad33703.7230350b.0.172af0b6bc4.N7abe</con2:id>
                        <con1:location>
                            <con2:xpathText xmlns:con2="http://www.bea.com/wli/sb/stages/config">.</con2:xpathText>
                        </con1:location>
                        <con1:expr>
                            <con2:xqueryText xmlns:con2="http://www.bea.com/wli/sb/stages/config">$cuerpo</con2:xqueryText>
                        </con1:expr>
                    </con1:replace>
                    <con1:reply xmlns:con1="http://www.bea.com/wli/sb/stages/config">
                        <con1:id>_ActionId-ad33703.7230350b.0.172af0b6bc4.N7abd</con1:id>
                    </con1:reply>
                </con:actions>
            </con:stage>
        </con:pipeline>
        <con:flow>
            <con:pipeline-node name="Pipeline Pair Node1">
                <con:request>request-ad33703.7230350b.0.172af0b6bc4.N8000</con:request>
                <con:response>response-ad33703.7230350b.0.172af0b6bc4.N7fff</con:response>
            </con:pipeline-node>
        </con:flow>
    </con:router>
</con:pipelineEntry>